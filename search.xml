<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title><![CDATA[在node项目中经常用到的一些东西]]></title>
    <url>%2F2019%2F09%2F18%2F%E5%9C%A8node%E9%A1%B9%E7%9B%AE%E4%B8%AD%E7%BB%8F%E5%B8%B8%E7%94%A8%E5%88%B0%E7%9A%84%E4%B8%80%E4%BA%9B%E4%B8%9C%E8%A5%BF%2F</url>
    <content type="text"><![CDATA[一.引入body-parserapp.js1234var bodyParser = require('body-parser')app.use(bodyParser.urlencoded(&#123;extended:false&#125;))app.use(bodyParser.json()) #### 二.引入sessionapp.js1234567var session = require('express-session')app.use(session(&#123; secret:'keyboard cat', resave:false, saveUninitialized:true&#125;)) router.js12345678910111213141516171819202122232425router.post('/login',function(req,res)&#123; var body = req.body User.findOne(&#123; emial:body.emial, password:body.password &#125;,function(err,user)&#123; if(err)&#123; return res.status(500).json(&#123; err_code:500, messages:"err" &#125;) &#125; if(!user)&#123; return res.status(200).json(&#123; err_code:0, messages:"emial has benn invilied" &#125;) &#125; req.session.user = user return res.status(200).json(&#123; err_code:1, messages:"ok" &#125;) &#125;)&#125;) 三.引入multerrouter.js1234567891011121314151617181920212223242526272829var multer =require('multer')var storage = multer.diskStorage(&#123; destination:function(req,file,cb)&#123; cb(null,'./uploads/qua-img') &#125;, filename:function(req,file,cb)&#123; var ext = file.originalname.split('.')[1] var tmname = (new Date()).getTime()+parseInt(Math.random()*9999) cb(null,''+tmname+'.'+ext+'') &#125;&#125;)var upload = multer(&#123; storage:storage&#125;);router.post('/qua-pic',function(req,res)&#123; var size= req.file if(size&gt;500000)&#123; res.status(500).json(&#123; err_code:-1, messages:"pic too big" &#125;) &#125; res.status(200).json(&#123; err_code:0, messages:"okk" &#125;)&#125;) 四.ajax模板xxx.js1234567891011121314151617181920$('#create-form').on('submit',function(e)&#123; e.preventDefault() var formData = $(this).serialize() $.ajax(&#123; type:'post', url:'/create', data:formData, dataType:'json', success:function(data)&#123; var err_code =data.err_code if(err_code===500)&#123; window.alert("服务器出错啦") &#125; else if(err_code===0)&#123; window.alert("提交成功") window.location.href='/create' &#125; &#125; &#125;)&#125;) 五.art-templateapp.js1app.engine(&apos;html&apos;,require(&apos;express-art-template&apos;)) 六.router配置app.js123var router = require('./router')app.use(router) ​ router.js 123var router =express.Router()module.exports = router 七.获取图片1234567891011121314151617181920212223var fs =require('fs')exports.getAllimgs = function(callback)&#123; fs.readdir('./uploads/qua-img',function(err,files)&#123; if(err)&#123; callback(err) return &#125; var allimgs = []; (function iterator(i)&#123; if(i==files.length)&#123; callback(allimgs) return &#125; fs.stat('./uploads/qua-img/'+files[i],function(err,stats)&#123; if(stats.isFile())&#123; allimgs.push(files[i]) &#125; iterator(i+1) &#125;) &#125;)(0) &#125;)&#125; 八.kindeditor引入123456789101112131415161718192021222324252627KindEditor.ready(function(K) &#123; editor = K.create('textarea[name="content"]', &#123; allowFileManager : true, afterBlur: function()&#123;this.sync();&#125;, uploadJson: '/uploadImg' &#125;);&#125;);router.post('/uploadImg',function(req,res,next)&#123; var form = new formidable.IncomingForm() form.keepExtensions = true form.uploadDir =__dirname + '/public/upload' form.parse(req,function(err,fields,files)&#123; if(err)&#123; throw err &#125; var image = files.imgFile; var path = image.path path = path.replace('/\\/g','/') var url = '/upload' +path.substr(path.lastIndexOf('/'),path.length) var info = &#123; "error":0, "url":url &#125;; res.send(info) &#125;)&#125;) 持续更新..]]></content>
      <categories>
        <category>前端</category>
      </categories>
      <tags>
        <tag>便捷</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[node+mongoose增删改查思路]]></title>
    <url>%2F2019%2F09%2F16%2Fnode-mongoose%E5%A2%9E%E5%88%A0%E6%94%B9%E6%9F%A5%E6%80%9D%E8%B7%AF%2F</url>
    <content type="text"><![CDATA[1.建立views视图页面 界面名称 url地址 index.html /home table.html /table edit.html /table/edit 2.安装相关模块插件12345678npm i -S express //安装组件npm i -S art-template npm i -S express-art-template //安装组件npm i -S body-parser //用于post获取数据npm i -g nodemon //全局安装，用于实时观察代码改动 3.建立node服务器12345678var express = require('express')var app = express() app.listen(3000,function()&#123; console.log("开始监听") &#125; &#125;) //开启端口127.0.0.1:3000的服务 4.node中启用相关插件12345678var body = require('body-parser')app.use('/public',express.static('./public/')) //用于使用public目录中的js，css等app.engine('html',require('express-art-template'))app.use(bodyParser.urlencoded([extend:false]))app.use(bodyParser.json()) 5.开启路由app.js端 123var router = require('./routers.js')app.use(router) //导入router模块 router端 1var router = express.Router() 6.定义传递方式路径 请求方式 传递路径 传递参数 备注 7.建立mongodb库1234567891011var mongoose = require(&apos;mongoose&apos;)mongoose.connect(&apos;mongodb:localhost://....&apos;)var schema = mongoose.schema()var userSchema = new schema(&#123; data:&#123;&#123;options&#125;&#125;&#125;)module.exports = mongooser.model(&quot;user&quot;,userSchema) 8.增删改查1234567891011//请自行查询mongoose语法，例：var user = require(&apos;./model/user.js&apos;)router.get(&apos;/&apos;,function(req,res)&#123; user.find(function(err)&#123; if(err)&#123; consolo.log(err) &#125; res.render(&apos;index.html&apos;) &#125;)&#125;)]]></content>
      <categories>
        <category>前端</category>
      </categories>
      <tags>
        <tag>nodejs</tag>
        <tag>mongodb</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[markdown基本语法]]></title>
    <url>%2F2019%2F09%2F15%2Fmarkdown%E5%9F%BA%E6%9C%AC%E8%AF%AD%E6%B3%95%2F</url>
    <content type="text"><![CDATA[链接 有链接我为什么要自己写？]]></content>
      <categories>
        <category>前端</category>
      </categories>
      <tags>
        <tag>html</tag>
        <tag>语法基础</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[突然好想你-五月天]]></title>
    <url>%2F2019%2F09%2F15%2F%E7%AA%81%E7%84%B6%E5%A5%BD%E6%83%B3%E4%BD%A0-%E4%BA%94%E6%9C%88%E5%A4%A9%2F</url>
    <content type="text"><![CDATA[目录 原链接 吉他谱 弹唱 总结 让我们开始吧​ 原谱链接 低音唱什么五月天？ ​]]></content>
      <categories>
        <category>吉他谱</category>
      </categories>
      <tags>
        <tag>有谱么</tag>
        <tag>弹唱</tag>
      </tags>
  </entry>
</search>
