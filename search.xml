<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title><![CDATA[nodejs最实用分页攻略]]></title>
    <url>%2F2019%2F09%2F20%2Fnodejs%E6%9C%80%E5%AE%9E%E7%94%A8%E5%88%86%E9%A1%B5%E6%94%BB%E7%95%A5%2F</url>
    <content type="text"><![CDATA[话不多说直接开始1.准备工作​ 在你看这篇文章想要进行分页时，请确保已经做好以下准备工作 ​ ——你的html页面已经搭建完成（表格，上一页/下一页，页面跳转） ​ ——你的后台数据已经通过模板或者循环成功的渲染到你的前台表格 2.给他们做一个点击事件，通过switch（if）操作1234567891011121314151617181920212223242526272829303132function jump(type) &#123; var nowpage = $('#nowpage').text() var allpage = $('#allpage').text() switch (type) &#123; case 'prev': if (nowpage &gt; 1) &#123; nowpage-- &#125; else &#123; alert('已经是第一页了') &#125; ; break; case 'next': if (nowpage &lt; allpage) &#123; nowpage++ &#125; else &#123; alert('已经是最后一页了') &#125; ; break; case 'go': if ($('#gopage').val() &gt; allpage) &#123; alert('输入页数错误了') &#125; else if ($('#gopage').val() &lt; 1) &#123; alert('输入页数错误了') &#125; else &#123; nowpage = $('#gopage').val() &#125;; break; &#125; window.location.href = '/create?page='+nowpage+''&#125; 3.后台操作1234567891011121314151617181920212223router.get('/create',function(req,res)&#123; var pagesize = req.query.pagesize || 10 var page = req.query.page || 1 var allcount1 = null Journalism.count(&#123;&#125;,function(err,allcount)&#123; if(err)&#123; res.status(500).send("Server Not Found") &#125; allcount1 = allcount &#125;) Journalism.find(function(err,journalisms)&#123; if(err)&#123; return res.status(500).send("Server Not Found") &#125; res.render('create.html',&#123; journalisms:journalisms, user:req.session.user, nowpage:page, allpage:Math.ceil(allcount1/pagesize) &#125;) &#125;).sort(&#123;'datatime':-1&#125;).limit(pagesize).skip((page-1)*pagesize) &#125;) 基本分页就此完成]]></content>
      <categories>
        <category>前端</category>
      </categories>
      <tags>
        <tag>nodejs</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[nodejs在表单中添加验证码验证]]></title>
    <url>%2F2019%2F09%2F20%2Fnodejs%E5%9C%A8%E8%A1%A8%E5%8D%95%E4%B8%AD%E6%B7%BB%E5%8A%A0%E9%AA%8C%E8%AF%81%E7%A0%81%E9%AA%8C%E8%AF%81%2F</url>
    <content type="text"><![CDATA[废话不多说了直接开始吧1，好一个简单的表单页面，just like，懒得改格式了你们将就哈12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061&lt;form id="formlist"&gt; &lt;div class="form-group"&gt; &lt;label for="exampleFormControlInput1"&gt;您的姓名&lt;/label&gt; &lt;input type="text" class="form-control" id="exampleFormControlInput1" placeholder="请输入正确的姓名方便我们的联系" name="username"&gt; &lt;/div&gt; &lt;div class="form-group"&gt; &lt;label for="exampleFormControlInput1"&gt;您的邮箱&lt;/label&gt; &lt;input type="email" class="form-control" id="exampleFormControlInput1" placeholder="请输入正确的邮箱方便我们的联系" name="emial"&gt; &lt;/div&gt; &lt;div class="form-group"&gt; &lt;label for="exampleFormControlInput1"&gt;您的手机号码&lt;/label&gt; &lt;input type="text" class="form-control" id="exampleFormControlInput1" placeholder="请输入正确的手机号方便我们的联系" name="phone"&gt; &lt;/div&gt; &lt;div class="form-group"&gt; &lt;label for="exampleFormControlSelect1"&gt;应聘合作相关&lt;/label&gt; &lt;select class="form-control" id="exampleFormControlSelect1" name="class"&gt; &lt;option&gt;应聘&lt;/option&gt; &lt;option&gt;合作&lt;/option&gt; &lt;option&gt;投诉&lt;/option&gt; &lt;option&gt;建议&lt;/option&gt; &lt;/select&gt; &lt;/div&gt; &lt;div class="form-group"&gt; &lt;label for="exampleFormControlTextarea1"&gt;具体内容&lt;/label&gt; &lt;textarea class="form-control" id="exampleFormControlTextarea1" rows="3" name="note"&gt;&lt;/textarea&gt; &lt;/div&gt; &lt;input type="text" placeholder="验证码" id="svgtext" name="svg"&gt; &lt;img src='/ver' onclick='changeSvg()' id="svgimg"&gt; &lt;br&gt; &lt;br&gt; &lt;div class="alert alert-warning" role="alert" id="control"&gt; 请输入验证码 &lt;/div&gt; &lt;br&gt; &lt;button type="button" class="btn btn-primary" data-toggle="modal" data-target="#exampleModal"&gt; 确认提交信息 &lt;/button&gt; &lt;!-- Modal --&gt; &lt;div class="modal fade" id="exampleModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true"&gt; &lt;div class="modal-dialog" role="document"&gt; &lt;div class="modal-content"&gt; &lt;div class="modal-header"&gt; &lt;h5 class="modal-title" id="exampleModalLabel"&gt;提交您的信息&lt;/h5&gt; &lt;button type="button" class="close" data-dismiss="modal" aria-label="Close"&gt; &lt;span aria-hidden="true"&gt;&amp;times;&lt;/span&gt; &lt;/button&gt; &lt;/div&gt; &lt;div class="modal-body"&gt; 请确认您填写的信息准确从而方便我们之间的联系 &lt;/div&gt; &lt;div class="modal-footer"&gt; &lt;button type="button" class="btn btn-secondary" data-dismiss="modal"&gt;再想想&lt;/button&gt; &lt;button type="submit" class="btn btn-primary"&gt;确定了&lt;/button&gt; &lt;/div&gt; &lt;/div&gt; &lt;/div&gt; &lt;/div&gt; &lt;/form&gt; 2.然后我们在router.js端做个验证码12345678var captcha = require('svg-captcha')router.get('/ver',function(req,res)&#123; var cap = captcha.create(); req.session.captcha = cap.text res.type('svg') res.send(cap.data);&#125;) 这样一来图片img的src路径指向该理由，从而显示验证码图片 3.做一个点击事件12345&lt;script&gt; function changeSvg()&#123; $(event.target).attr('src','/ver?'+Math.random()) &#125; &lt;/script&gt; 4.最后便是提交表单的ajax了12345678910111213141516171819202122232425262728$('#formlist').on('submit',function(e)&#123; e.preventDefault() var formData = $(this).serialize() $.ajax(&#123; type:'post', url:'/person', data:formData, dataType:'json', success:function(data)&#123; var err_code =data.err_code if(err_code===500)&#123; window.alert("服务器出错啦") &#125; else if(err_code===1)&#123; window.alert("验证码错误请重试") $('#control').attr("class","alert alert-danger") $('#control').text('请输入正确的验证码,注意大小写的区分哦') $('#svgimg').attr('src','/ver?'+Math.random()) &#125; else if(err_code===0)&#123; window.alert("您的信息已经提交成功") $('#control').attr("class","alert alert-success") $('#control').text('验证码输入正确') window.location.href = '/person' &#125; &#125; &#125;)&#125;) 关于表单提交的post路由就不贴了，这样一个验证系统就差不多多好了( ´Д`)y━・ 如有问题可以提问]]></content>
      <categories>
        <category>前端</category>
      </categories>
      <tags>
        <tag>nodejs</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[在node项目中经常用到的一些东西]]></title>
    <url>%2F2019%2F09%2F18%2F%E5%9C%A8node%E9%A1%B9%E7%9B%AE%E4%B8%AD%E7%BB%8F%E5%B8%B8%E7%94%A8%E5%88%B0%E7%9A%84%E4%B8%80%E4%BA%9B%E4%B8%9C%E8%A5%BF%2F</url>
    <content type="text"><![CDATA[一.引入body-parserapp.js1234var bodyParser = require('body-parser')app.use(bodyParser.urlencoded(&#123;extended:false&#125;))app.use(bodyParser.json()) #### 二.引入sessionapp.js1234567var session = require('express-session')app.use(session(&#123; secret:'keyboard cat', resave:false, saveUninitialized:true&#125;)) router.js12345678910111213141516171819202122232425router.post('/login',function(req,res)&#123; var body = req.body User.findOne(&#123; emial:body.emial, password:body.password &#125;,function(err,user)&#123; if(err)&#123; return res.status(500).json(&#123; err_code:500, messages:"err" &#125;) &#125; if(!user)&#123; return res.status(200).json(&#123; err_code:0, messages:"emial has benn invilied" &#125;) &#125; req.session.user = user return res.status(200).json(&#123; err_code:1, messages:"ok" &#125;) &#125;)&#125;) 三.引入multerrouter.js1234567891011121314151617181920212223242526272829var multer =require('multer')var storage = multer.diskStorage(&#123; destination:function(req,file,cb)&#123; cb(null,'./uploads/qua-img') &#125;, filename:function(req,file,cb)&#123; var ext = file.originalname.split('.')[1] var tmname = (new Date()).getTime()+parseInt(Math.random()*9999) cb(null,''+tmname+'.'+ext+'') &#125;&#125;)var upload = multer(&#123; storage:storage&#125;);router.post('/qua-pic',function(req,res)&#123; var size= req.file if(size&gt;500000)&#123; res.status(500).json(&#123; err_code:-1, messages:"pic too big" &#125;) &#125; res.status(200).json(&#123; err_code:0, messages:"okk" &#125;)&#125;) 四.ajax模板xxx.js1234567891011121314151617181920$('#create-form').on('submit',function(e)&#123; e.preventDefault() var formData = $(this).serialize() $.ajax(&#123; type:'post', url:'/create', data:formData, dataType:'json', success:function(data)&#123; var err_code =data.err_code if(err_code===500)&#123; window.alert("服务器出错啦") &#125; else if(err_code===0)&#123; window.alert("提交成功") window.location.href='/create' &#125; &#125; &#125;)&#125;) 五.art-templateapp.js1app.engine(&apos;html&apos;,require(&apos;express-art-template&apos;)) 六.router配置app.js123var router = require('./router')app.use(router) ​ router.js 123var router =express.Router()module.exports = router 七.获取图片1234567891011121314151617181920212223var fs =require('fs')exports.getAllimgs = function(callback)&#123; fs.readdir('./uploads/qua-img',function(err,files)&#123; if(err)&#123; callback(err) return &#125; var allimgs = []; (function iterator(i)&#123; if(i==files.length)&#123; callback(allimgs) return &#125; fs.stat('./uploads/qua-img/'+files[i],function(err,stats)&#123; if(stats.isFile())&#123; allimgs.push(files[i]) &#125; iterator(i+1) &#125;) &#125;)(0) &#125;)&#125; 八.kindeditor引入123456789101112131415161718192021222324252627KindEditor.ready(function(K) &#123; editor = K.create('textarea[name="content"]', &#123; allowFileManager : true, afterBlur: function()&#123;this.sync();&#125;, uploadJson: '/uploadImg' &#125;);&#125;);router.post('/uploadImg',function(req,res,next)&#123; var form = new formidable.IncomingForm() form.keepExtensions = true form.uploadDir =__dirname + '/public/upload' form.parse(req,function(err,fields,files)&#123; if(err)&#123; throw err &#125; var image = files.imgFile; var path = image.path path = path.replace('/\\/g','/') var url = '/upload' +path.substr(path.lastIndexOf('/'),path.length) var info = &#123; "error":0, "url":url &#125;; res.send(info) &#125;)&#125;) 持续更新..]]></content>
      <categories>
        <category>前端</category>
      </categories>
      <tags>
        <tag>便捷</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[node+mongoose增删改查思路]]></title>
    <url>%2F2019%2F09%2F16%2Fnode-mongoose%E5%A2%9E%E5%88%A0%E6%94%B9%E6%9F%A5%E6%80%9D%E8%B7%AF%2F</url>
    <content type="text"><![CDATA[1.建立views视图页面 界面名称 url地址 index.html /home table.html /table edit.html /table/edit 2.安装相关模块插件12345678npm i -S express //安装组件npm i -S art-template npm i -S express-art-template //安装组件npm i -S body-parser //用于post获取数据npm i -g nodemon //全局安装，用于实时观察代码改动 3.建立node服务器12345678var express = require('express')var app = express() app.listen(3000,function()&#123; console.log("开始监听") &#125; &#125;) //开启端口127.0.0.1:3000的服务 4.node中启用相关插件12345678var body = require('body-parser')app.use('/public',express.static('./public/')) //用于使用public目录中的js，css等app.engine('html',require('express-art-template'))app.use(bodyParser.urlencoded([extend:false]))app.use(bodyParser.json()) 5.开启路由app.js端 123var router = require('./routers.js')app.use(router) //导入router模块 router端 1var router = express.Router() 6.定义传递方式路径 请求方式 传递路径 传递参数 备注 7.建立mongodb库1234567891011var mongoose = require(&apos;mongoose&apos;)mongoose.connect(&apos;mongodb:localhost://....&apos;)var schema = mongoose.schema()var userSchema = new schema(&#123; data:&#123;&#123;options&#125;&#125;&#125;)module.exports = mongooser.model(&quot;user&quot;,userSchema) 8.增删改查1234567891011//请自行查询mongoose语法，例：var user = require(&apos;./model/user.js&apos;)router.get(&apos;/&apos;,function(req,res)&#123; user.find(function(err)&#123; if(err)&#123; consolo.log(err) &#125; res.render(&apos;index.html&apos;) &#125;)&#125;)]]></content>
      <categories>
        <category>前端</category>
      </categories>
      <tags>
        <tag>nodejs</tag>
        <tag>mongodb</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[markdown基本语法]]></title>
    <url>%2F2019%2F09%2F15%2Fmarkdown%E5%9F%BA%E6%9C%AC%E8%AF%AD%E6%B3%95%2F</url>
    <content type="text"><![CDATA[链接 有链接我为什么要自己写？]]></content>
      <categories>
        <category>前端</category>
      </categories>
      <tags>
        <tag>html</tag>
        <tag>语法基础</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[突然好想你-五月天]]></title>
    <url>%2F2019%2F09%2F15%2F%E7%AA%81%E7%84%B6%E5%A5%BD%E6%83%B3%E4%BD%A0-%E4%BA%94%E6%9C%88%E5%A4%A9%2F</url>
    <content type="text"><![CDATA[目录 原链接 吉他谱 弹唱 总结 让我们开始吧​ 原谱链接 低音唱什么五月天？ ​]]></content>
      <categories>
        <category>吉他谱</category>
      </categories>
      <tags>
        <tag>有谱么</tag>
        <tag>弹唱</tag>
      </tags>
  </entry>
</search>
